#-------------------------------------------------------------------------------
rm(list=ls())
#-------------------------------------------------------------------------------
# CALCULO DO NUCLEO
#-------------------------------------------------------------------------------
UNK<-function(n,k){
   if(((4*n+1)>170)||((4*k+1)>170)){
#      cat("VALRES DE k =",k,"E n =",n,"PARA 2(k+n)+1 =",2*(k+n)+1,"MAIORES QUE 170\n")
      return(0)
   }else{
      V<-((2^n)*((-1)^k)*factorial(k+n))/(factorial(k)*factorial(2*(k+n)+1))
      return(V)
   }
}
#-------------------------------------------------------------------------------
# k<-0:K
# n<-0:N
#-------------------------------------------------------------------------------
K<-30
N<-30
x<-20
#-------------------------------------------------------------------------------
if(N<K){
   n<-K
}else{
   n<-N
}
nk<-0:n
U<-outer(nk,nk,FUN='UNK')
#-------------------------------------------------------------------------------
xkn<-function(n,k){
   return(x^(2*k+n))
}
#-------------------------------------------------------------------------------
xk<-outer(nk,nk,FUN='xkn')
Jnk<-U*xk
Jn<-rowSums(Jnk)
#-------------------------------------------------------------------------------
#U<-U[1:(N+1),]
