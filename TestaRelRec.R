#-------------------------------------------------------------------------------
rm(list=ls())
source("BSC.R")
#-------------------------------------------------------------------------------
x<-5
y<-6
z<-4
lmax<-8
#-------------------------------------------------------------------------------
rho<-sqrt(x^2+y^2)
r<-sqrt(rho^2+z^2)
cth<-z/r
sth<-rho/r
LMAX=lmax*(lmax+2)+1
#-------------------------------------------------------------------------------
cmlm<-function(l,m){
   return(sqrt(l*(l+1)-m*(m-1)))
}
#-------------------------------------------------------------------------------
cplm<-function(l,m){
   return(sqrt(l*(l+1)-m*(m+1)))
}
#-------------------------------------------------------------------------------
u<-LegendrePolynomialsQlm(cth,lmax+1)
#-------------------------------------------------------------------------------
cpq<-rep(0,LMAX)
cmq<-rep(0,LMAX)
ll<-rep(0,LMAX)
mm<-rep(0,LMAX)
for(l in 0:lmax){
   m<--l:l
   ll[jlm(l,m)]<-l
   mm[jlm(l,m)]<-m
   cpq[jlm(l,m)]<-cplm(l,m)*u$Qlm[jlm(l,m+1)]
   cmq[jlm(l,m)]<-cmlm(l,m)*u$Qlm[jlm(l,m-1)]
}
u<-u[1:LMAX,]
ao<-mm*u$Qlm*(r/rho)^2
ai<-mm*u$Qlm-(z/rho)*(cmq+cpq)/2
bo<-(z/r)*u$dQlm
bi<-(z/rho)*(cmq-cpq)/2
co<-2*mm*(z/rho)*u$Qlm
ci<-(cmq+cpq)
cbind(ao,ai)
cbind(bo,bi)
#-------------------------------------------------------------------------------

